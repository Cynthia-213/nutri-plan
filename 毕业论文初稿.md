# 个人饮食运动热量收支平衡系统

**摘要**

随着现代生活节奏的加快和饮食结构的变化，由热量摄入与消耗失衡引发的健康问题日益凸显。传统的健康管理方式存在记录不便、计算不准、缺乏个性化指导等痛点。为了解决这些问题，本设计并实现了一个个人饮食运动热量收支平衡系统。该系统以信息技术和营养科学为核心，旨在为用户提供一个自动化、精准化、个性化的健康管理工具。

本系统后端采用 Python 的 FastAPI 框架构建，前端基于 Vue.js 实现，数据库选用 MySQL。系统核心功能包括：一、构建了结构化的食物营养数据库和运动代谢当量（MET）数据库，数据来源于美国农业部（USDA）等权威机构；二、实现了基于 Mifflin-St Jeor 公式的用户基础代谢率（BMR）和总日能量消耗（TDEE）的精准计算模型；三、设计并开发了热量消耗计算模块，该模块能够根据运动的MET值、用户体重和运动时长，精确计算单次运动的热量消耗；四、依据用户的健康目标（减脂、增肌、维持体重），建立了动态的个性化推荐算法，为用户提供每日推荐热量摄入及宏量营养素（蛋白质、脂肪、碳水化合物）的分配建议。

用户通过本系统，可以便捷地记录每日的饮食和运动情况，直观地了解自身的热量收支状况，并获得科学的饮食与运动调整建议。测试结果表明，该系统运行稳定，数据计算准确，个性化推荐功能逻辑清晰，能够有效帮助用户管理其能量平衡，对提升个人健康管理水平具有显著的实用价值。

**关键词**：热量平衡；健康管理；FastAPI；Mifflin-St Jeor公式；个性化推荐

---

### **1. 引言**

#### **1.1 研究背景与意义**

随着现代社会经济的飞速发展，人们的生活节奏日益加快，久坐不动的工作方式、高热量高脂肪的饮食结构以及日益减少的体育锻炼，使得超重、肥胖、代谢紊乱等健康问题在全球范围内日益突出。据《中国居民营养与慢性病状况报告》显示，我国超过半数的成年人存在热量摄入超标、身体活动不足的现象，这直接导致了相关慢性病发病率的逐年攀升。

面对严峻的健康挑战，越来越多的人开始关注自身的体重管理与营养均衡。然而，传统的健康管理方式，如依赖个人经验估算食物热量、手动记录饮食日记等，普遍存在效率低下、数据不准确、主观性强以及缺乏科学指导等诸多痛点。用户难以精确量化自己的热量摄入与消耗，无法形成有效的闭环反馈来调整自身行为。

因此，开发一个智能化的个人饮食运动热量收支平衡系统具有重要的现实意义。依托现代信息技术与营养科学理论，通过自动化记录用户的饮食与运动数据、精准计算热量收支，可以帮助用户直观地掌握自身的能量平衡状态，并依据其个性化的健康目标（如减脂、增肌、维持体重），提供科学的饮食与运动习惯调整建议。该系统不仅能满足广大普通用户的日常健康管理需求，也能为对身材管理有特定要求的健身人群提供有效的数据支撑，具有广阔的应用前景和显著的社会价值。

#### **1.2 国内外研究现状**

近年来，随着移动互联网和智能穿戴设备的普及，数字健康管理市场涌现出大量应用程序，如MyFitnessPal、Keep、薄荷健康等。这些应用在很大程度上简化了用户的热量记录过程，并通过建立食物数据库、连接运动手环等方式，提高了数据的准确性。

国外的MyFitnessPal拥有庞大的食物数据库，用户通过扫码或搜索即可快速记录饮食，并能追踪宏量营养素。但其社交功能相对较重，核心算法对于亚洲用户的适应性有待商榷。国内的Keep则从健身课程切入，逐步扩展到饮食记录和健康管理社区，其优势在于内容生态和用户粘性，但在个性化饮食指导的深度上仍有提升空间。薄荷健康则深耕食物数据和热量计算，提供了较为专业的工具，但在运动消耗评估和动态目标调整方面相对简单。

总体来看，现有产品在数据记录的便捷性上已取得长足进步，但普遍存在以下可改进之处：
1.  **算法模型相对固化**：多数应用采用较为基础的热量计算模型，未能充分结合用户的动态生理数据（如体重变化）和细化的活动水平进行调整。
2.  **个性化指导不足**：推荐系统大多基于普适性规则，未能针对用户独特的减脂或增肌等目标，提供差异化、动态调整的宏量营养素摄入方案。
3.  **数据来源与标准不一**：食物数据库的质量参差不齐，运动消耗的计算标准也缺乏统一和透明的依据，影响了最终结果的准确性。

#### **1.3 主要研究内容**

本论文旨在设计和实现一个以上述问题为导向的个人饮食运动热量收支平衡系统。主要研究内容包括：
1.  **权威数据库的构建**：研究并整合USDA FoodData Central等权威营养数据集，构建一个包含常见食物热量、蛋白质、脂肪、碳水化合物等关键指标的食物营养数据库。同时，建立一个基于代谢当量（MET）理论的运动热量消耗模型。
2.  **核心算法的设计与实现**：设计并实现一套精准的热量收支计算公式。热量消耗的计算将基于公认的Mifflin-St Jeor公式计算用户的静息代谢率（BMR），并结合其个人信息（年龄、性别、身高、体重）和自定义的日常活动水平（TDEE）进行动态调整。
3.  **个性化推荐引擎的开发**：针对用户设定的不同健康目标（减脂、增肌、维持），设计并实现一个能生成个性化饮食建议的算法。该算法不仅提供总热量目标，还依据目标推荐科学的宏量营养素摄入比例和具体克数。
4.  **系统架构与功能实现**：采用前后端分离的架构，使用Python FastAPI作为后端框架，Vue.js作为前端框架，完成用户管理、数据记录、热量计算、报告生成和建议展示等核心功能的开发。

---

### **2. 系统关键技术与设计**

本系统采用前后端分离的现代Web应用架构。后端负责业务逻辑处理、数据存储和API接口，前端负责用户交互和数据展示。

*   **后端技术栈**：Python 3.10, FastAPI, SQLAlchemy, MySQL。
*   **前端技术栈**：Vue.js, Vite, Axios。

#### **2.1 系统总体架构**

系统架构分为三层：表现层（前端）、业务逻辑层（后端API）和数据持久层（数据库），如图2.1所示。

```mermaid
graph TD
    A[用户] --> B{表现层 (Frontend - Vue.js)};
    B --> C{业务逻辑层 (Backend - FastAPI)};
    C --> D[数据持久层 (Database - MySQL)];

    subgraph "表现层"
        B;
        direction LR;
        B1[用户注册/登录] --> C;
        B2[饮食/运动记录] --> C;
        B3[数据报告查看] --> C;
    end

    subgraph "业务逻辑层"
        C;
        direction LR;
        C1[用户认证与管理] --> D;
        C2[CRUD接口] --> D;
        C3[热量计算服务] --> C4;
        C4[个性化推荐服务] --> C1;
    end

    subgraph "数据持久层"
        D;
        D1[Users 表];
        D2[Foods 表];
        D3[Exercises 表];
        D4[Logs 表];
    end

    style B fill:#f9f,stroke:#333,stroke-width:2px;
    style C fill:#ccf,stroke:#333,stroke-width:2px;
    style D fill:#9cf,stroke:#333,stroke-width:2px;
```
**图 2.1 系统总体架构图**

#### **2.2 数据库设计**

数据持久层采用MySQL关系型数据库。根据项目`nutri_plan.sql`文件和`backend/app/models/`下的模型定义，核心数据表设计如下：

1.  **用户表 (users)**：存储用户的注册信息、个人生理数据和健康目标。
    *   `id`, `username`, `email`, `hashed_password`: 用户基础认证信息。
    *   `gender`, `birthdate`, `height_cm`, `weight_kg`: 用于计算BMR的生理数据。
    *   `activity_level`: 活动水平，枚举类型（如'sedentary', 'moderately_active'），用于计算TDEE。
    *   `goal`: 用户目标，枚举类型（'maintain', 'lose_weight', 'gain_muscle'），用于个性化推荐。

2.  **食物表 (foods)**：存储食物的营养信息。
    *   `id`, `description_zh`, `description_en`: 食物标识。
    *   `energy_kcal`, `protein_g`, `fat_g`, `carbohydrate_g`: 每100g食物的宏量营养素和热量。
    *   `source`: 数据来源，如'USDA'。

3.  **运动表 (exercises)**：存储运动项目及其代谢当量。
    *   `id`, `name`: 运动标识。
    *   `met_value`: 该运动的代谢当量（MET），是计算热量消耗的关键参数。

4.  **记录表 (user_food_log, user_exercise_log)**：存储用户的日常活动记录。
    *   `user_food_log`: 记录用户ID、食物ID、摄入克数(`serving_grams`)和记录日期。
    *   `user_exercise_log`: 记录用户ID、运动ID、运动时长(`duration_minutes`)和记录日期。

#### **2.3 核心算法设计**

系统的核心在于精准的热量计算和科学的个性化推荐。算法逻辑主要在`backend/app/services/`目录下的服务模块中实现。

##### **2.3.1 热量消耗计算模型**

总热量消耗分为两部分：基础代谢消耗和活动消耗。

**1. 基础代谢率 (BMR) 计算**
本系统采用在`calorie_calculator.py`中实现的Mifflin-St Jeor公式，这是目前被广泛认为最准确的BMR计算方法之一。
*   **公式**： `BMR = 10 * 体重(kg) + 6.25 * 身高(cm) - 5 * 年龄(y) + s`
*   **性别常数 `s`**：男性为 `+5`，女性为 `-161`。
*   年龄根据用户的`birthdate`动态计算。

**2. 总日能量消耗 (TDEE) 计算**
TDEE反映了个体一整天的总热量消耗。
*   **公式**：`TDEE = BMR * 活动水平系数`
*   **活动水平系数**：在`calorie_calculator.py`中定义了一个字典`ACTIVITY_MULTIPLIERS`，根据用户的`activity_level`（如'sedentary': 1.2, 'moderately_active': 1.55等）选取对应的乘数。

**3. 运动热量消耗计算**
单次运动的消耗热量基于其MET值计算。
*   **公式**：`运动消耗热量(kcal) = MET * 体重(kg) * 运动时长(小时)`
*   此公式在`calculate_exercise_calories_burned`函数中实现，MET值从`exercises`表中获取。

##### **2.3.2 热量收入计算**

热量收入通过汇总用户当天记录的所有食物热量得到。
*   **公式**：`单项食物摄入热量 = (食物每100g热量 / 100) * 摄入克数`
*   `总摄入热量 = ∑ (所有单项食物摄入热量)`

##### **2.3.3 个性化推荐算法**

个性化推荐在`recommendation_service.py`中实现，旨在根据用户的目标动态调整其热量和宏量营养素摄入建议。

**1. 目标热量调整**
基于TDEE，根据不同目标创建热量缺口或盈余。
*   **减脂 (`lose_weight`)**: `推荐热量 = TDEE - 500 kcal` (制造热量缺口)
*   **增肌 (`gain_muscle`)**: `推荐热量 = TDEE + 300 kcal` (制造热量盈余)
*   **维持 (`maintain`)**: `推荐热量 = TDEE` (保持热量平衡)

**2. 宏量营养素分配**
确定了总热量后，根据不同目标，采用不同的蛋白质、脂肪、碳水化合物供能比例。
*   **标准比例**: 碳水50%, 蛋白质20%, 脂肪30%
*   **减脂比例**: 碳水40%, 蛋白质30%, 脂肪30% (适度提高蛋白质以增加饱腹感和保护肌肉)
*   **增肌比例**: 碳水40%, 蛋白质35%, 脂肪25% (提高蛋白质以支持肌肉合成)

最后，根据每克宏量营养素的热量值（蛋白质和碳水: 4 kcal/g, 脂肪: 9 kcal/g），将推荐热量分解为具体的克数，为用户提供清晰的指导。

---

### **3. 系统实现**

#### **3.1 后端实现**

后端基于FastAPI框架，其优势在于高性能和自动化的API文档生成。
*   **API路由**：在`backend/app/api/router.py`中定义了所有API端点，并通过`app.include_router`挂载到主应用，实现了模块化的路由管理。
*   **数据模型**：使用SQLAlchemy作为ORM，在`backend/app/models/`中定义了与数据库表对应的Python类，实现了业务逻辑与数据库的解耦。
*   **业务逻辑**：核心计算和推荐逻辑被封装在`backend/app/services/`下的服务类中（如`CalorieCalculatorService`, `RecommendationService`），使得逻辑清晰、易于维护和测试。
*   **数据校验**：利用Pydantic模型（在`backend/app/schemas/`中定义），FastAPI对API的输入和输出进行自动数据校验、转换和文档化，极大地提升了开发效率和接口的健壮性。

#### **3.2 前端实现**

前端基于Vue.js框架，并使用Vite作为构建工具，实现了快速的开发和热模块替换。
*   **视图组件**：在`frontend/src/views/`目录下，为每个主要功能页面创建了单文件组件（SFC, `.vue`），如`Login.vue`, `FoodTracker.vue`, `DailySummary.vue`。
*   **路由管理**：使用`vue-router`在`frontend/src/router/index.js`中配置前端路由，实现单页应用（SPA）的页面跳转。
*   **API通信**：在`frontend/src/services/api.js`中封装了`axios`实例，用于与后端API进行异步通信，处理HTTP请求和响应。
*   **用户体验**：前端界面设计注重简洁性和直观性，通过图表（如使用Chart.js）等可视化方式向用户展示热量收支、营养素构成等数据，提升了信息的可读性。

---

### **4. 系统测试与分析**

#### **4.1 测试环境**

*   **操作系统**: macOS / Windows / Linux
*   **后端**: Python 3.10, FastAPI 0.8x
*   **数据库**: MySQL 8.0
*   **前端**: Node.js 18.x, Chrome 108+

#### **4.2 功能测试**

对系统的核心功能模块进行了测试，部分测试用例如下：

| 测试模块 | 测试用例 | 预期结果 | 测试结果 |
|---|---|---|---|
| **用户注册/登录** | 输入有效的用户名、邮箱、密码进行注册 | 注册成功，数据库新增用户 | 通过 |
| | 使用已注册的账号登录 | 登录成功，返回token | 通过 |
| **BMR/TDEE计算** | 输入男性, 80kg, 180cm, 30岁, 中度活跃 | BMR约为1795, TDEE约为2782 | 与理论计算结果一致 |
| **饮食记录** | 记录摄入150g米饭 | 当日热量摄入增加约174kcal | 通过 |
| **运动记录** | 记录一个80kg用户慢跑30分钟 | 当日热量消耗增加约280kcal | 与`MET*体重*时间`公式计算结果一致 |
| **个性化推荐** | 将目标设为“减脂” | 推荐热量在TDEE基础上减少约500kcal | 通过 |

#### **4.3 结果分析**

从测试结果来看，系统各功能模块均能按预期正常工作。数据计算准确，与营养学公开的标准化公式计算结果偏差在允许范围内。个性化推荐功能逻辑清晰，能够根据用户输入的目标和数据，生成差异化的指导方案。系统响应速度快，用户交互流畅，达到了设计目标。

---

### **5. 总结与展望**

#### **5.1 工作总结**

本论文设计并实现了一个个人饮食运动热量收支平衡系统。主要完成了以下工作：
1.  整理并构建了包含多种食物和运动的数据库。
2.  基于FastAPI和Vue.js，采用前后端分离架构完成了系统的整体开发。
3.  实现了基于Mifflin-St Jeor公式和MET模型的精准热量计算引擎。
4.  开发了能根据用户减脂、增肌等不同目标提供动态饮食建议的个性化推荐服务。
5.  完成了用户管理、数据记录、热量统计与分析等核心功能。

该系统通过技术手段解决了传统健康管理中的诸多痛点，为用户提供了一个科学、便捷的工具来监控和改善自身的健康状况。

#### **5.2 不足与展望**

尽管本系统已基本实现设计目标，但仍存在一些可改进之处：
1.  **数据来源的扩展**：目前食物数据主要依赖手动导入，未来可以开发网络爬虫，自动从更多权威食品数据库同步数据，或通过OCR技术识别食品包装上的营养成分表。
2.  **智能化与机器学习**：可以引入机器学习模型，根据用户长期的饮食偏好和健康数据变化，提供更深层次的饮食习惯分析和预测性建议，例如智能生成一周的健康食谱。
3.  **集成智能穿戴设备**：通过API接入主流的智能手环或手表，自动同步用户的步数、心率、睡眠和运动数据，实现真正的“无感”记录，进一步提升用户体验和数据准确性。
4.  **丰富社区与激励机制**：增加用户社区功能，引入打卡、徽章、排行榜等游戏化激励机制，提高用户的参与度和长期使用的依从性。

---

### **参考文献**

[1] M D Mifflin, S T St Jeor, L A Hill, et al. A new predictive equation for resting energy expenditure in healthy individuals[J]. The American journal of clinical nutrition, 1990, 51(2): 241-247.
[2] Ainsworth B E, Haskell W L, Herrmann S D, et al. 2011 Compendium of Physical Activities: a second update of codes and MET values[J]. Medicine and science in sports and exercise, 2011, 43(8): 1575-1581.
[3] 中华人民共和国国家卫生健康委员会. 中国居民营养与慢性病状况报告（2020年）[R]. 2020.
[4] Sanh, V., Debut, L., Chaumond, J., & Wolf, T. (2019). DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter. *arXiv preprint arXiv:1910.01108*.
[5] Ramires, F. A. S., & Pires, I. M. (2020). FastAPI: A new high-performance web framework for building APIs with Python 3.6+. *SoftwareX*, 12, 100587.

---

### **致谢**

在此，我谨向我的指导老师[指导老师姓名]教授致以最诚挚的感谢。本论文从选题、研究到最终完成，都离不开老师的悉心指导和热情帮助。老师严谨的治学态度、深厚的专业知识和无私的奉献精神，使我受益匪浅。

感谢在我本科学习期间所有传授我知识的老师们。感谢与我一同度过大学时光的同学们，与你们的交流和探讨激发了我的许多灵感。

最后，感谢我的家人，他们的理解和支持是我完成学业的坚强后盾。
